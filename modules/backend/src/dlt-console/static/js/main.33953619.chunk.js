(this["webpackJsonpdlt-console"]=this["webpackJsonpdlt-console"]||[]).push([[0],{204:function(e,t,a){e.exports=a(335)},210:function(e,t,a){},335:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),l=a(59),o=a.n(l),r=(a(209),a(210),a(28)),i=a(29),c=a(12),m=a(31),u=a(30),d=a(196),h=a(52),g=a(22),f=a(26),p=a(192),v=a(32),E=a(370),b=a(371),y=a(372),k=a(373),S=a(374),N=a(375),O=a(380),M=a(381),V=a(382),F=a(376),L=a(47),C=a(60),T=a(76),x=a(377),w=a(16),j=a.n(w),I=a(27),P=a(378),_=a(359),D=a(360),B=a(361),U=a(178),A=a(362),z=a(363),R=a(173),H=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).getItems=Object(I.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({Items:[],isLoading:!0}),e.prev=1,e.next=4,R.a.get("dlts","/engines");case 4:t=e.sent,n.setState({Items:t.Items,isLoading:!1}),0===t.Items.length?n.setState({noData:!0}):n.setState({noData:!1}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),"response"in e.t0&&"undefined"!==typeof e.t0.response&&"duplicate_engine"===e.t0.response.data.error?n.handleApiError(e.t0):alert(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),n.state={Items:[],isLoading:!0,noData:!1,modal:!1,modalTitle:null,modalText:null},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getItems()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.state.Items,t=s.a.createElement("div",{className:"welcome"},s.a.createElement("h2",null,"To get started select ",s.a.createElement("strong",null,"Launch Engine")," from the top menu.")),a=s.a.createElement(P.a,{isOpen:this.state.modal},s.a.createElement(_.a,{toggle:this.toggle},this.state.modalTitle),s.a.createElement(D.a,null,this.state.modalText),s.a.createElement(B.a,null,s.a.createElement(U.a,{color:"secondary",onClick:this.closeModal},"Close"))),n=s.a.createElement("tbody",{ref:this.tableBody},e.map((function(e){return s.a.createElement("tr",{key:e.engine_type},s.a.createElement("td",null,e.engine_type.charAt(0).toUpperCase()+e.engine_type.slice(1)),s.a.createElement("td",null,e.description),s.a.createElement("td",null,e.started),s.a.createElement("td",null,e.engine_status),s.a.createElement("td",{className:"td-center"},s.a.createElement(h.b,{to:{pathname:"/manage/"+e.engine_type,state:{engine_type:e.engine_type}}},s.a.createElement(f.a,{icon:v.a,size:"lg"}))))})));return s.a.createElement("div",null,s.a.createElement("div",{className:"box heading-box"},s.a.createElement("h1",null,"Dashboard"),s.a.createElement(U.a,{onClick:this.getItems,size:"sm"},"Refresh")),a,s.a.createElement("div",{className:"box"},s.a.createElement("h1",null,"Engines"),s.a.createElement(A.a,{className:"dashboard",borderless:!0,responsive:!0},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Type"),s.a.createElement("th",null,"Description"),s.a.createElement("th",null,"Started (UTC)"),s.a.createElement("th",null,"Status"),s.a.createElement("th",{className:"td-center"},"Manage"))),n),this.state.isLoading?s.a.createElement("div",{className:"loading"},s.a.createElement(z.a,{color:"secondary"})):s.a.createElement("div",null)),this.state.noData?t:s.a.createElement("div",null))}}]),a}(s.a.Component),W=a(160),$=(a(101),a(92)),G=a.n($),q=a(379),J=a(364),K=a(365),Q=a(366),X=a(367),Y=a(368),Z=a(369),ee=(a(159),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).launchLocust=Object(I.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.formValues,n.form.current.reportValidity()){e.next=3;break}return e.abrupt("return",!1);case 3:if(!(n.state.formValues.fargateTaskCount>n.state.formValues.fargateTaskServiceLimit)){e.next=6;break}return n.setState({modal:!0,modalTitle:"Task count",modalText:"Task count: "+n.state.formValues.fargateTaskCount+" is greater than the AWS accounts service limit of "+n.state.formValues.fargateTaskServiceLimit}),e.abrupt("return",!1);case 6:return n.setState({isLoading:!0}),!0===t.customLocustFile&&n.putLocustFile(),e.prev=8,a={numMasterNodes:parseInt(t.numMasterNodes),masterNodeVcpu:parseInt(t.masterNodeVcpu),masterNodeMemory:parseInt(t.masterNodeMemory),numSlaveNodes:parseInt(t.numSlaveNodes),slaveNodeVcpu:parseInt(t.slaveNodeVcpu),slaveNodeMemory:parseInt(t.slaveNodeMemory),locustFileName:t.customLocustFile?"/scenarios/locust/custom/"+t.customLocustFileName:"/"+t.locustFileSelection,customLocustFile:t.customLocustFile},e.next=12,R.a.post("dlts","/engine/launch/locust",{body:a});case 12:n.setState({isLoading:!1}),n.goHome(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),"response"in e.t0&&"undefined"!==typeof e.t0.response&&"duplicate_engine"===e.t0.response.data.error?n.handleApiError(e.t0):n.setState({modal:!0,modalTitle:e.t0.message,modalText:e.t0.message+"- Request to "+e.t0.config.url+" failed"});case 19:case"end":return e.stop()}}),e,null,[[8,16]])}))),n.fargatePricing=Object(I.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),e.prev=1,e.next=4,R.a.get("dlts","/pricing/fargate");case 4:t=e.sent,n.setState({fargateVcpuPrice:parseFloat(t.vcpu),fargateMemoryPrice:parseFloat(t.memory)}),n.calculateFargatePricing(),n.setState({isLoading:!1}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.setState({modal:!0,modalTitle:"Pricing error",modalText:"Failed to get Fargate pricing information"});case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),n.getLocustFiles=Object(I.a)(j.a.mark((function e(){var t,a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.formValues,n.setState({isLoading:!0}),e.prev=2,e.next=5,W.a.list("scenarios/locust",{level:"public"});case 5:if(0!==(a=e.sent).length){e.next=10;break}n.setState({isLoading:!1,noData:!0}),e.next=25;break;case 10:return t.locustFiles=a,t.locustFileSelection=a[0].key,t.customLocustFile=!1,e.prev=13,e.next=16,W.a.get(a[0].key,{level:"public",download:!0});case 16:s=e.sent,t.locustFile=s,e.next=23;break;case 20:e.prev=20,e.t0=e.catch(13),alert(e.t0);case 23:t.locustFileName=t.locustFileSelection.split("/")[t.locustFileSelection.split("/").length-1],n.setState({formValues:t});case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(2),alert(e.t1);case 30:case"end":return e.stop()}}),e,null,[[2,27],[13,20]])}))),n.putLocustFile=Object(I.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.formValues,e.prev=1,e.next=4,W.a.put("scenarios/locust/custom/"+t.customLocustFileName,t.customLocustFileBody,{level:"public"});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),alert(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])}))),n.getLocustFileBody=function(){var e=Object(I.a)(j.a.mark((function e(t){var a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.formValues,e.prev=1,e.next=4,W.a.get(t,{level:"public",download:!0});case 4:s=e.sent,a.locustFile=s,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0);case 11:n.setState({formValues:a});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),n.state={isLoading:!1,runningTasks:!1,modal:!1,modalTitle:null,modalText:null,refreshPricing:!1,fargateVcpuPrice:null,fargateMemoryPrice:null,fargateVcpuSimCost:null,fargateMemorySimCost:null,fargateSimTotalCost:null,formValues:{vCpuOptions:[{label:"0.25",value:"256",id:1},{label:"0.5",value:"512",id:2},{label:"1",value:"1024",id:3},{label:"2",value:"2048",id:4},{label:"4",value:"4096",id:5}],fargateTaskServiceLimit:100,fargateTaskCount:0,fargateRunTimeHours:24,masterMemoryOptions:[],slaveMemoryOptions:[],numMasterNodes:"1",masterNodeVcpu:"512",masterNodeMemory:"2048",numSlaveNodes:"1",slaveNodeVcpu:"512",slaveNodeMemory:"2048",locustFiles:[],locustFile:"",locustFileSelection:"",locustFileName:"",customLocustFile:!1,customLocustFileBody:"",customLocustFileName:""}},n.form=s.a.createRef(),n.handleInputChange=n.handleInputChange.bind(Object(c.a)(n)),n.setFormValue=n.setFormValue.bind(Object(c.a)(n)),n.masterMemoryOptions=n.masterMemoryOptions.bind(Object(c.a)(n)),n.slaveMemoryOptions=n.slaveMemoryOptions.bind(Object(c.a)(n)),n.handleLocustFileSelection=n.handleLocustFileSelection.bind(Object(c.a)(n)),n.handleLocustFile=n.handleLocustFile.bind(Object(c.a)(n)),n.handleLocustFileSelection=n.handleLocustFileSelection.bind(Object(c.a)(n)),n.handleLocustFileBody=n.handleLocustFileBody.bind(Object(c.a)(n)),n.closeModal=n.closeModal.bind(Object(c.a)(n)),n.openInfoModal=n.openInfoModal.bind(Object(c.a)(n)),n.handleTaskLimitChanges=n.handleTaskLimitChanges.bind(Object(c.a)(n)),n.getLocustFiles=n.getLocustFiles.bind(Object(c.a)(n)),n.goHome=n.goHome.bind(Object(c.a)(n)),n}return Object(i.a)(a,[{key:"handleTaskLimitChanges",value:function(e){}},{key:"goHome",value:function(){this.props.history.push("/")}},{key:"calculateFargatePricing",value:function(){var e=this,t=this.state,a=parseInt(t.formValues.numMasterNodes)+parseInt(t.formValues.numSlaveNodes),n=parseFloat(t.formValues.vCpuOptions.find((function(t){return t.value===e.state.formValues.masterNodeVcpu})).label),s=parseFloat(t.formValues.vCpuOptions.find((function(t){return t.value===e.state.formValues.slaveNodeVcpu})).label),l=parseFloat(t.formValues.masterMemoryOptions.find((function(t){return t.value===e.state.formValues.masterNodeMemory})).label),o=parseFloat(t.formValues.slaveMemoryOptions.find((function(t){return t.value===e.state.formValues.slaveNodeMemory})).label),r=(parseInt(t.formValues.numMasterNodes)+parseInt(t.formValues.numSlaveNodes))*(n+s)*t.fargateVcpuPrice*t.formValues.fargateRunTimeHours,i=(parseInt(t.formValues.numMasterNodes)+parseInt(t.formValues.numSlaveNodes))*(l+o)*t.fargateMemoryPrice*t.formValues.fargateRunTimeHours,c=r+i;t.fargateVcpuSimCost=r,t.fargateMemorySimCost=i,t.fargateSimTotalCost=c,t.formValues.fargateTaskCount=a,this.setState({values:t})}},{key:"componentDidMount",value:function(){this.initialMemoryOptions(),this.getLocustFiles(),this.fargatePricing()}},{key:"setFormValue",value:function(e,t){var a=this.state.formValues;a[e]=t,this.setState({formValues:a})}},{key:"handleInputChange",value:function(e){var t=e.target.value,a=e.target.name;this.setFormValue(a,t),"masterNodeMemory"!==a&&"slaveNodeMemory"!==a&&"numSlaveNodes"!==a&&"fargateRunTimeHours"!==a||this.calculateFargatePricing()}},{key:"handleLocustFile",value:function(e){var t=this.state.formValues;t.locustFileName="woop woop",this.setState({formValues:t})}},{key:"handleLocustFileSelection",value:function(e){var t=e.target.value,a=e.target.name,n=this.state.formValues;this.setFormValue(a,t),"Custom"===t&&"locustFileSelection"===a?(n.locustFile=null,n.customLocustFile=!0,n.customLocustFileName="custom_locust_file_"+Object(q.a)()+".py",this.setState({formValues:n})):"locustFileName"===a?(n.customLocustFile=!0,n.customLocustFileName=t,this.setState({formValues:n})):(n.locustFile=null,n.customLocustFile=!1,n.customLocustFileBody="",n.locustFileName=n.locustFileSelection.split("/")[n.locustFileSelection.split("/").length-1],this.setState({formValues:n}),this.getLocustFileBody(t))}},{key:"handleLocustFileBody",value:function(e){var t=this.state.formValues;t.customLocustFileBody=e,this.setState({formValues:t})}},{key:"initialMemoryOptions",value:function(){var e=this.state.formValues;switch(e.masterNodeVcpu){case"256":e.masterMemoryOptions=[{value:"0.5",id:1},{value:"1",id:2},{value:"2",id:3}],this.setState({formValues:e});break;case"512":e.masterMemoryOptions.length=0;for(var t=1;t<=4;t++)e.masterMemoryOptions.push({label:t.toString(),value:(1024*t).toString(),id:t});this.setState({formValues:e});break;case"1024":e.masterMemoryOptions.length=0;for(var a=2;a<=8;a++)e.masterMemoryOptions.push({label:a.toString(),value:(1024*a).toString(),id:a});this.setState({formValues:e});break;case"2048":e.masterMemoryOptions.length=0;for(var n=4;n<=16;n++)e.masterMemoryOptions.push({label:n.toString(),value:(1024*n).toString(),id:n});this.setState({formValues:e});break;case"4096":e.masterMemoryOptions.length=0;for(var s=8;s<=30;s++)e.masterMemoryOptions.push({label:s.toString(),value:(1024*s).toString(),id:s});this.setState({formValues:e})}switch(e.slaveNodeVcpu){case"256":e.slaveMemoryOptions=[{value:"0.5",id:1},{value:"1",id:2},{value:"2",id:3}],this.setState({formValues:e});break;case"512":e.slaveMemoryOptions.length=0;for(var l=1;l<=4;l++)e.slaveMemoryOptions.push({label:l.toString(),value:(1024*l).toString(),id:l});this.setState({formValues:e});break;case"1024":e.slaveMemoryOptions.length=0;for(var o=2;o<=8;o++)e.slaveMemoryOptions.push({label:o.toString(),value:(1024*o).toString(),id:o});this.setState({formValues:e});break;case"2048":e.slaveMemoryOptions.length=0;for(var r=4;r<=16;r++)e.slaveMemoryOptions.push({label:r.toString(),value:(1024*r).toString(),id:r});this.setState({formValues:e});break;case"4096":e.slaveMemoryOptions.length=0;for(var i=8;i<=30;i++)e.slaveMemoryOptions.push({label:i.toString(),value:(1024*i).toString(),id:i});this.setState({formValues:e})}}},{key:"masterMemoryOptions",value:function(e){this.handleInputChange(e);var t=e.target.value,a=this.state.formValues;switch(t){case"256":a.masterMemoryOptions=[{label:"0.5",value:512..toString(),id:1},{label:"1",value:1024..toString(),id:2},{label:"2",value:2048..toString(),id:3}],a.masterNodeMemory=1024..toString(),this.setState({formValues:a}),this.calculateFargatePricing();break;case"512":a.masterMemoryOptions.length=0,a.masterNodeMemory=2048..toString();for(var n=1;n<=4;n++)a.masterMemoryOptions.push({label:n.toString(),value:(1024*n).toString(),id:n});this.setState({formValues:a}),this.calculateFargatePricing();break;case"1024":a.masterMemoryOptions.length=0,a.masterNodeMemory=2048..toString();for(var s=2;s<=8;s++)a.masterMemoryOptions.push({label:s.toString(),value:(1024*s).toString(),id:s});this.setState({formValues:a}),this.calculateFargatePricing();break;case"2048":a.masterMemoryOptions.length=0,a.masterNodeMemory=4096..toString();for(var l=4;l<=16;l++)a.masterMemoryOptions.push({label:l.toString(),value:(1024*l).toString(),id:l});this.setState({formValues:a}),this.calculateFargatePricing();break;case"4096":a.masterMemoryOptions.length=0,a.masterNodeMemory=8192..toString();for(var o=8;o<=30;o++)a.masterMemoryOptions.push({label:o.toString(),value:(1024*o).toString(),id:o});this.setState({formValues:a}),this.calculateFargatePricing()}}},{key:"slaveMemoryOptions",value:function(e){this.handleInputChange(e);var t=e.target.value,a=this.state.formValues;switch(t){case"256":a.slaveMemoryOptions=[{label:"0.5",value:512..toString(),id:1},{label:"1",value:1024..toString(),id:2},{label:"2",value:2048..toString(),id:3}],a.slaveNodeMemory=1024..toString(),this.setState({formValues:a}),this.calculateFargatePricing();break;case"512":a.slaveMemoryOptions.length=0,a.slaveNodeMemory=1024..toString();for(var n=1;n<=4;n++)a.slaveMemoryOptions.push({label:n.toString(),value:(1024*n).toString(),id:n});this.setState({formValues:a}),this.calculateFargatePricing();break;case"1024":a.slaveMemoryOptions.length=0,a.slaveNodeMemory=2048..toString();for(var s=2;s<=8;s++)a.slaveMemoryOptions.push({label:s.toString(),value:(1024*s).toString(),id:s});this.setState({formValues:a}),this.calculateFargatePricing();break;case"2048":a.slaveMemoryOptions.length=0,a.slaveNodeMemory=4096..toString();for(var l=4;l<=16;l++)a.slaveMemoryOptions.push({label:l.toString(),value:(1024*l).toString(),id:l});this.setState({formValues:a}),this.calculateFargatePricing();break;case"4096":a.slaveMemoryOptions.length=0,a.slaveNodeMemory=8192..toString();for(var o=8;o<=30;o++)a.slaveMemoryOptions.push({label:o.toString(),value:(1024*o).toString(),id:o});this.setState({formValues:a}),this.calculateFargatePricing()}}},{key:"handleApiError",value:function(e){this.setState({modal:!0,modalTitle:e.message,modalText:e.response.data.error_text+" at "+e.response.data.data.Items[0].started+". Please go back to the dashboard and manage the already existing engine"})}},{key:"closeModal",value:function(){this.setState({modal:!1,modalTitle:null,modalText:null,isLoading:!1})}},{key:"openInfoModal",value:function(){this.setState({modal:!0,modalTitle:"Pricing info",modalText:s.a.createElement("p",null,"Pricing info is taken from the pricing API for Fargate tasks spun up in Sydney provided by AWS and the method for calculation used is provided ",s.a.createElement("a",{className:"text-link",onClick:this.closeModal,target:"_blank",href:"https://aws.amazon.com/fargate/pricing/",rel:"noopener noreferrer"}," here ",s.a.createElement(f.a,{size:"sm",icon:v.c})),". Does not include egress data charges")})}},{key:"render",value:function(){var e=s.a.createElement("div",{className:"box cheading-box"},s.a.createElement("h1",null,"Launch Locust engine"),s.a.createElement(U.a,{size:"sm",onClick:this.launchLocust},"Launch")),t=this.state.formValues.vCpuOptions.map((function(e){return s.a.createElement("option",{key:e.id,label:e.label,value:e.value},e.label)})),a=this.state.formValues.masterMemoryOptions.map((function(e){return s.a.createElement("option",{key:e.id,label:e.label,value:e.value})})),n=this.state.formValues.slaveMemoryOptions.map((function(e){return s.a.createElement("option",{key:e.id,label:e.label,value:e.value},e.label)})),l=s.a.createElement(P.a,{isOpen:this.state.modal},s.a.createElement(_.a,{toggle:this.toggle},this.state.modalTitle),s.a.createElement(D.a,null,this.state.modalText),s.a.createElement(B.a,null,s.a.createElement(U.a,{color:"secondary",onClick:this.closeModal},"Close"))),o=s.a.createElement("div",null,s.a.createElement(J.a,null,s.a.createElement(K.a,{xs:"2"},s.a.createElement("div",{className:"box create-box"},s.a.createElement("h3",null,"Settings"),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"numOfMasterNodes"},"# of master nodes"),s.a.createElement(Y.a,{type:"number",name:"numOfMasterNodes",id:"numOfMasterNodes",defaultValue:this.state.formValues.numMasterNodes,readOnly:!0,required:!0}),s.a.createElement(Z.a,{color:"muted"},"The number of master nodes for the cluster. This will default to 1")),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"masterNodeVcpu"},"Master node vCPU"),s.a.createElement(Y.a,{type:"select",value:this.state.formValues.masterNodeVcpu,onChange:this.masterMemoryOptions,name:"masterNodeVcpu",id:"masterNodeVcpu"},t),s.a.createElement(Z.a,{color:"muted"},"The amount of vCPU to assign to the master node tasks")),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"masterNodeMemory"},"Master node memory"),s.a.createElement(Y.a,{type:"select",value:this.state.formValues.masterNodeMemory,onChange:this.handleInputChange,name:"masterNodeMemory",id:"masterNodeMemory"},a),s.a.createElement(Z.a,{color:"muted"},"The amount of memory in GB to assign to the master node tasks")),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"numSlaveNodes"},"# of slave nodes"),s.a.createElement(Y.a,{type:"number",name:"numSlaveNodes",id:"numSlaveNodes",defaultValue:"1",onChange:this.handleInputChange,required:!0}),s.a.createElement(Z.a,{color:"muted"},"The number of slaves to connect to the master node for distributed testing. The total number of master nodes + slave nodes should fit within the accounts service limits for fargate tasks")),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"slaveNodeVcpu"},"Slave node vCPU"),s.a.createElement(Y.a,{type:"select",value:this.state.formValues.slaveNodeVcpu,onChange:this.slaveMemoryOptions,name:"slaveNodeVcpu",id:"slaveNodeVcpu"},t),s.a.createElement(Z.a,{color:"muted"},"The amount of vCPU to assign to the slave node tasks")),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"slaveNodeMemory"},"Slave node memory"),s.a.createElement(Y.a,{type:"select",value:this.state.formValues.slaveNodeMemory,onChange:this.handleInputChange,name:"slaveNodeMemory",id:"slaveNodeMemory"},n),s.a.createElement(Z.a,{color:"muted"},"The amount of memory in GB to assign to the slave node tasks")))),s.a.createElement(K.a,{xs:"10"},s.a.createElement("div",{className:"box create-box"},s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"locustFileSelection"},"Locust file selection"),s.a.createElement(Y.a,{type:"select",onChange:this.handleLocustFileSelection,name:"locustFileSelection",id:"locustFileSelection"},this.state.formValues.locustFiles.length>0?this.state.formValues.locustFiles.map((function(e,t){return s.a.createElement("option",{key:t,label:e.key,value:e.key},e.key)})):null,s.a.createElement("option",{key:"999",label:"Custom",value:"Custom"},"Custom")),s.a.createElement(Z.a,{color:"muted"},"Select a default locust file that contains a predefined test scenario")),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"locustFile"},"Locust file"),s.a.createElement(G.a,{mode:"python",theme:"github",showGutter:!0,highlightActiveLine:!0,name:"locustFile",width:"inherit",height:"500px",onChange:this.handleLocustFileBody,readOnly:!0!==this.state.formValues.customLocustFile,value:null!==this.state.formValues.locustFile?this.state.formValues.locustFile.Body:this.state.formValues.customLocustFileBody,required:!0,setOptions:{showLineNumbers:!0,tabSize:4,useSoftTabs:!0,wrapBehavioursEnabled:!0,autoScrollEditorIntoView:!0,showPrintMargin:!1},editorProps:{$blockScrolling:1/0}}),s.a.createElement(Z.a,{color:"muted"},"A valid Python Locust file https://docs.locust.io/en/stable/quickstart.html")),s.a.createElement(Q.a,null,s.a.createElement(X.a,{for:"locustFileName"},"Locust file name"),s.a.createElement(Y.a,{type:"text",name:"locustFileName",id:"locustFileName",readOnly:!0!==this.state.formValues.customLocustFile,onChange:this.handleLocustFileSelection,value:!0===this.state.formValues.customLocustFile?this.state.formValues.customLocustFileName:this.state.formValues.locustFileName,required:!0}),s.a.createElement(Z.a,{color:"muted"},"If custom locust file input a name to save the file as. Otherwise it's just the name of the file"),!0===this.state.formValues.customLocustFile?s.a.createElement(Z.a,{color:"red"},"If the file name already exists the file will be overwritten. In addition remember to back up your custom file if you wish to keep it because the custom file is stored in the consoles S3 bucket and will be destroyed alongside the solution when it's torn down."):null)))),s.a.createElement("div",{className:"box"},s.a.createElement("h3",null,"Estimated cost:"),s.a.createElement(U.a,{id:"info",onClick:this.openInfoModal,color:"link"},s.a.createElement(f.a,{id:"icon",icon:v.d})," Info"),s.a.createElement(J.a,null,s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result form-inline"},s.a.createElement(X.a,{for:"fargateTaskServiceLimit"},"Account Fargate task limit:"),s.a.createElement(Y.a,{type:"number",name:"fargateTaskServiceLimit",id:"fargateTaskServiceLimit",defaultValue:this.state.formValues.fargateTaskServiceLimit,onChange:this.handleInputChange,bsSize:"sm"}))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result form-inline"},s.a.createElement(X.a,{for:"fargateRunTimeHours"},"Simulated runtime (Hours):"),s.a.createElement(Y.a,{type:"number",name:"fargateRunTimeHours",id:"fargateRunTimeHours",defaultValue:this.state.formValues.fargateRunTimeHours,onChange:this.handleInputChange,bsSize:"sm"}))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result"},s.a.createElement("b",null,"vCPU cost (USD):"),s.a.createElement("span",null,"$",this.state.fargateVcpuPrice))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result"},s.a.createElement("b",null,"Memory cost (USD):"),s.a.createElement("span",null,"$",this.state.fargateMemoryPrice)))),s.a.createElement(J.a,null,s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result"},s.a.createElement("b",null,"Task acount:"),s.a.createElement("span",null,this.state.formValues.fargateTaskCount," out of ",this.state.formValues.fargateTaskServiceLimit),this.state.formValues.fargateTaskCount>this.state.formValues.fargateTaskServiceLimit?s.a.createElement(Z.a,{color:"red"},"Number of tasks exceeds service limits for account"):null)),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result"},s.a.createElement("b",null,"Esimated vCPU cost:"),s.a.createElement("span",null,"$",this.state.fargateVcpuSimCost))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result"},s.a.createElement("b",null,"Esimated memory cost:"),s.a.createElement("span",null,"$",this.state.fargateMemorySimCost))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"price result"},s.a.createElement("b",null,"Estimated total simulated cost:"),s.a.createElement("span",null,"$",this.state.fargateSimTotalCost))))));return s.a.createElement("div",null,s.a.createElement("form",{ref:this.form,onSubmit:function(e){return e.preventDefault()}},l,this.state.isLoading?s.a.createElement("div",{className:"loading"},s.a.createElement(z.a,{color:"secondary"})):e,s.a.createElement("div",null,this.state.isLoading?s.a.createElement("div",{className:"loading"},s.a.createElement(z.a,{color:"secondary"})):o)))}}]),a}(s.a.Component)),te=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).getTasks=Object(I.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({tasks:[],isLoading:!0}),e.prev=1,e.next=4,R.a.get("dlts","/engine/"+n.state.engine_name+"/tasks");case 4:0===(t=e.sent).length?n.setState({isLoading:!1,noData:!0}):n.setState({isLoading:!1,tasks:t.tasks}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0);case 11:n.taskStatus();case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),n.state={isLoading:!1,refresh:!1,engine_name:n.props.engineName,taskCount:n.props.taskCount,provisioning:0,pending:0,running:0,tasks:[],ecs_dashboard:awsConfig.ecs_dashboard+awsConfig.load_testing_name+"-"+n.props.engineName},n.getTasks=n.getTasks.bind(Object(c.a)(n)),n.taskStatus=n.taskStatus.bind(Object(c.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getTasks()}},{key:"componentDidUpdate",value:function(e,t){this.props.refresh!==e.refresh?(this.getTasks(),this.setState({refresh:!this.props.refresh})):this.props.taskCount!==e.taskCount&&this.setState({taskCount:this.props.taskCount})}},{key:"taskStatus",value:function(){var e=this.state.tasks,t=0,a=0,n=0;for(var s in e)switch(e[s].lastStatus){case"PROVISIONING":++t;break;case"PENDING":++a;break;case"RUNNING":++n}this.setState({provisioning:t,pending:a,running:n})}},{key:"render",value:function(){var e=s.a.createElement("div",{className:"box"},s.a.createElement("h3",null,"Tasks Status:"),s.a.createElement("span",{className:"console"},"Details for the running tasks can be viewed in the ",s.a.createElement("a",{className:"text-link",href:this.state.ecs_dashboard,target:"_blank",rel:"noopener noreferrer"},"Amazon ECS Console ",s.a.createElement(f.a,{size:"sm",icon:v.c}))),s.a.createElement(J.a,null,s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"result"},s.a.createElement("b",null,"Task Count:"),s.a.createElement("span",null,this.state.tasks.length," of ",this.state.taskCount))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"result"},s.a.createElement("b",null,"Provisioning Count:"),s.a.createElement("span",null,this.state.provisioning))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"result"},s.a.createElement("b",null,"Pending Count:"),s.a.createElement("span",null,this.state.pending))),s.a.createElement(K.a,{sm:"3"},s.a.createElement("div",{className:"result"},s.a.createElement("b",null,"Running Count:"),s.a.createElement("span",null,this.state.running)))));return s.a.createElement("div",null,this.state.isLoading?s.a.createElement("div",{className:"loading"},s.a.createElement(z.a,{color:"secondary"})):e)}}]),a}(s.a.Component),ae=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).getEngine=Object(I.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),e.prev=1,e.next=4,R.a.get("dlts","/engine/"+n.state.engine_name);case 4:t=e.sent,n.setState({Items:t.Items,isLoading:!1}),0===t.Items.length&&n.setState({noData:!0}),n.setState({isLoading:!1}),n.sendTaskCount(),n.getLocustFileBody(t.Items[0].locustFileName),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),alert(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])}))),n.getLocustFileBody=function(){var e=Object(I.a)(j.a.mark((function e(t){var a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state,e.prev=1,e.next=4,W.a.get(t.slice(1),{level:"public",download:!0});case 4:s=e.sent,a.locustFile=s,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0);case 11:n.setState({formValues:a});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),n.state={Items:[],isLoading:!1,refresh:!1,info:!1,infoText:null,engine_name:n.props.engineName,engineAlbAddress:"http://"+awsConfig.engine_alb_address,locustFile:null},n.toggleInfo=n.toggleInfo.bind(Object(c.a)(n)),n.getLocustFileBody=n.getLocustFileBody.bind(Object(c.a)(n)),n}return Object(i.a)(a,[{key:"toggleInfo",value:function(){this.setState({info:!this.state.info,infoText:"This console only manages the Locust engines resources including the test scenario. Managing the actual locust engine (Starting and stopping load tests) is done via the below management URL"})}},{key:"componentDidMount",value:function(){this.getEngine()}},{key:"sendTaskCount",value:function(){this.state.Items.length>0&&this.props.taskCount(parseInt(this.state.Items[0].numMasterNodes)+parseInt(this.state.Items[0].numSlaveNodes))}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){this.props.refresh!==e.refresh&&(this.getEngine(),this.setState({refresh:!this.props.refresh}))}},{key:"render",value:function(){var e=this,t=this.state.Items,a=s.a.createElement("div",null,t.map((function(t){return s.a.createElement("div",{key:t.engine_type,className:"box"},s.a.createElement("h3",null,"Settings"),s.a.createElement(J.a,null,s.a.createElement(K.a,{xs:"6",sm:"4"},s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"3"},s.a.createElement("b",null,"Type")),s.a.createElement(K.a,{sm:"9"},e.state.engine_name.charAt(0).toUpperCase()+e.state.engine_name.slice(1))),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"3"},s.a.createElement("b",null,"Description")),s.a.createElement(K.a,{sm:"9"},t.description)),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"3"},s.a.createElement("b",null,"Last updated")),s.a.createElement(K.a,{sm:"9"},t.last_updated)),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"3"},s.a.createElement("b",null,"Management URL")),s.a.createElement(K.a,{sm:"9"},s.a.createElement("a",{className:"text-link",href:e.state.engineAlbAddress,target:"_blank",rel:"noopener noreferrer"},e.state.engineAlbAddress," ",s.a.createElement(f.a,{size:"sm",icon:v.c}))))),s.a.createElement(K.a,{xs:"6",sm:"4"},s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"3"},s.a.createElement("b",null,"# of master nodes")),s.a.createElement(K.a,{sm:"9"},t.numMasterNodes)),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"3"},s.a.createElement("b",null,"Master node vCPU")),s.a.createElement(K.a,{sm:"9"},t.masterNodeVcpu)),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"3"},s.a.createElement("b",null,"Master node memory")),s.a.createElement(K.a,{sm:"9"},t.masterNodeMemory))),s.a.createElement(K.a,{xs:"6",sm:"4"},s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"4"},s.a.createElement("b",null,"# of slave nodes")),s.a.createElement(K.a,{sm:"8"},t.numSlaveNodes)),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"4"},s.a.createElement("b",null,"Slave node vCPU")),s.a.createElement(K.a,{sm:"8"},t.slaveNodeVcpu)),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,{sm:"4"},s.a.createElement("b",null,"Slave node memory")),s.a.createElement(K.a,{sm:"8"},t.slaveNodeMemory)))),s.a.createElement(J.a,{className:"detail"},s.a.createElement(K.a,null,s.a.createElement("b",null,"Locust file")),s.a.createElement(G.a,{mode:"python",theme:"github",showGutter:!0,highlightActiveLine:!0,name:"locustFile",width:"100%",height:"500px",readOnly:!0,value:null===e.state.locustFile?"":e.state.locustFile.Body,setOptions:{showLineNumbers:!0,tabSize:4,useSoftTabs:!0,wrapBehavioursEnabled:!0,autoScrollEditorIntoView:!0,showPrintMargin:!1},editorProps:{$blockScrolling:1/0}})))})));return s.a.createElement("div",null,this.state.isLoading?s.a.createElement("div",{className:"loading"},s.a.createElement(z.a,{color:"secondary"})):a)}}]),a}(s.a.Component),ne=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).deleteLocust=Object(I.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),e.prev=1,e.next=4,R.a.del("dlts","/engine/locust");case 4:n.setState({isLoading:!1}),n.props.history.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),n.state={Items:[],isLoading:!1,refresh:!1,info:!1,infoText:null,noData:!0,modal:!1,modalTitle:null,modalText:null,engine_name:n.props.engineName},n.form=s.a.createRef(),n.confirmDelete=n.confirmDelete.bind(Object(c.a)(n)),n.closeModal=n.closeModal.bind(Object(c.a)(n)),n.toggleInfo=n.toggleInfo.bind(Object(c.a)(n)),n.deleteLocust=n.deleteLocust.bind(Object(c.a)(n)),n.taskCount=n.taskCount.bind(Object(c.a)(n)),n.refresh=n.refresh.bind(Object(c.a)(n)),n}return Object(i.a)(a,[{key:"toggleInfo",value:function(){this.setState({info:!this.state.info,infoText:"This console only manages the Locust engines resources including the test scenario. Managing the actual locust engine (Starting and stopping load tests) is done via the below management URL"})}},{key:"refresh",value:function(){this.setState({refresh:!this.state.refresh})}},{key:"confirmDelete",value:function(){this.setState({modal:!0,modalTitle:"Confirmation",modalText:s.a.createElement("p",null,"Click ",s.a.createElement("strong",null,s.a.createElement("u",null,"Delete"))," to begin the process to remove this load testing engine")})}},{key:"closeModal",value:function(){this.setState({modal:!1,modalTitle:null,modalText:null})}},{key:"taskCount",value:function(e){this.setState({taskCount:e})}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=s.a.createElement(P.a,{isOpen:this.state.modal},s.a.createElement(_.a,null,this.state.modalTitle),s.a.createElement(D.a,null,this.state.modalText),s.a.createElement(B.a,null,s.a.createElement(U.a,{onClick:this.deleteLocust,size:"sm",color:"danger"},"Delete"),s.a.createElement(U.a,{onClick:this.closeModal,size:"sm"},"Cancel"))),t=s.a.createElement("div",null,s.a.createElement("div",{className:"box heading-box"},s.a.createElement("h1",null,"Manage ",this.state.engine_name.charAt(0).toUpperCase()+this.state.engine_name.slice(1)),s.a.createElement(U.a,{size:"sm",onClick:this.confirmDelete,color:"danger"},"Delete"),s.a.createElement(U.a,{size:"sm",onClick:this.refresh},"Refresh")),s.a.createElement(ae,{engineName:this.state.engine_name,refresh:this.state.refresh,taskCount:this.taskCount}),s.a.createElement(te,{engineName:this.state.engine_name,refresh:this.state.refresh,taskCount:this.state.taskCount}));return s.a.createElement("div",null,s.a.createElement("form",{ref:this.form,onSubmit:function(e){return e.preventDefault()}},e,s.a.createElement("div",null,this.state.isLoading?s.a.createElement("div",{className:"loading"},s.a.createElement(z.a,{color:"secondary"})):t)))}}]),a}(s.a.Component),se=Object(g.f)(ne),le=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={isLoading:!1,engine_name:n.props.match.params.engine,modal:!1,modalTitle:null,modalText:null},n.closeModal=n.closeModal.bind(Object(c.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"notFoundModal",value:function(){this.setState({modal:!0,modalTitle:"Engine error",modalText:s.a.createElement("p",null,"No engine by the name of ",this.state.engine_name," found")})}},{key:"closeModal",value:function(){this.setState({modal:!1,modalTitle:null,modalText:null}),this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=s.a.createElement("div",null,function(){switch(e.state.engine_name){case"locust":return s.a.createElement(se,{engineName:e.state.engine_name});default:return s.a.createElement(P.a,{isOpen:"true"},s.a.createElement(_.a,null,"Engine error"),s.a.createElement(D.a,null,s.a.createElement("p",null,"No engine by the name of ",e.state.engine_name," found")),s.a.createElement(B.a,null,s.a.createElement(U.a,{onClick:e.closeModal,size:"sm"},"Ok")))}}());return s.a.createElement("div",null,t)}}]),a}(s.a.Component);a(313);L.default.configure(awsConfig);var oe={sectionFooterSecondaryContent:Object(d.a)({},T.a.sectionFooterSecondaryContent,{display:"none"})},re=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).noMatch=n.noMatch.bind(Object(c.a)(n)),n.signOut=n.signOut.bind(Object(c.a)(n)),n.toggleNavbar=n.toggleNavbar.bind(Object(c.a)(n)),n.state={collapsed:!0},n}return Object(i.a)(a,[{key:"noMatch",value:function(e){var t=e.location;return s.a.createElement("div",null,s.a.createElement("h3",null,"Error 404 Page not found: ",s.a.createElement("code",null,t.pathname)))}},{key:"toggleNavbar",value:function(){this.setState({collapsed:!this.state.collapsed})}},{key:"signOut",value:function(){C.a.signOut(),window.location.reload()}},{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(h.a,null,s.a.createElement(E.a,{color:"dark",dark:!0,fixed:"top",expand:"md"},s.a.createElement(b.a,{href:"/"}," ",s.a.createElement(f.a,{icon:p.a,size:"lg",color:"#FF9900",id:"logo"})," Distributed Load Testing"),s.a.createElement(y.a,{onClick:this.toggleNavbar,className:"mr-2"}),s.a.createElement(k.a,{isOpen:!this.state.collapsed,navbar:!0},s.a.createElement(S.a,{className:"mr-auto",navbar:!0},s.a.createElement(N.a,null,s.a.createElement(h.b,{to:"/dashboard",className:"nav-link"},s.a.createElement(f.a,{id:"icon",icon:v.b})," Dashboard")),s.a.createElement(y.a,{onClick:this.toggle}),s.a.createElement(k.a,{isOpen:this.state.isOpen,navbar:!0},s.a.createElement(S.a,{className:"ml-auto",navbar:!0},s.a.createElement(O.a,{nav:!0,inNavbar:!0},s.a.createElement(M.a,{nav:!0,caret:!0},s.a.createElement(f.a,{id:"icon",icon:v.e}),"  Launch engine"),s.a.createElement(V.a,{right:!0},s.a.createElement(F.a,null,s.a.createElement(h.b,{to:{pathname:"/launch/locust",state:{engine_type:"locust"}}},"Locust"))))))),s.a.createElement(S.a,{className:"ml-auto",navbar:!0},s.a.createElement(N.a,null,s.a.createElement(h.b,{to:"",onClick:this.signOut,className:"nav-link"},s.a.createElement(f.a,{id:"icon",icon:v.f})," Sign Out"))))),s.a.createElement("div",{className:"main"},s.a.createElement(g.c,null,s.a.createElement(g.a,{path:"/",exact:!0,component:H}),s.a.createElement(g.a,{path:"/dashboard",exact:!0,component:H}),s.a.createElement(g.a,{path:"/launch/locust",exact:!0,component:ee}),s.a.createElement(g.a,{path:"/manage/:engine",exact:!0,component:le}),s.a.createElement(g.a,{component:this.noMatch})),s.a.createElement("div",{className:"footer"},s.a.createElement("p",null,"For help please see the ",s.a.createElement("a",{className:"text-link",href:"https://github.com/melbourneit-es/int-terraform-aws-loadtesting",target:"_blank",rel:"noopener noreferrer"},"solution home page ",s.a.createElement(f.a,{size:"sm",icon:v.c})))))))}}]),a}(s.a.Component),ie=Object(x.a)(re,!1,[],null,oe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(ie,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[204,1,2]]]);
//# sourceMappingURL=main.33953619.chunk.js.map